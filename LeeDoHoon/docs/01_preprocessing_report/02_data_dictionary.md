# 02. 데이터 사전 (Data Dictionary)

> **작성자**: 이도훈 (LDH)  
> **작성일**: 2025-12-16  
> **버전**: v1.0

---

## 1. train_v2.csv

> 학습 데이터 - 타겟 라벨 포함

| # | 컬럼명 | 데이터 타입 | 설명 | 비즈니스 의미 | 예시값 | 결측치 |
|---|--------|-------------|------|---------------|--------|--------|
| 1 | `msno` | string (hash) | 사용자 고유 ID | 마스킹된 회원 번호 | `ugx0Cj...` | 0 |
| 2 | `is_churn` | int (0/1) | 이탈 여부 | **타겟 변수** | 0, 1 | 0 |

### 타겟 변수 상세

| 값 | 의미 | 사용자 수 | 비율 |
|----|------|-----------|------|
| 0 | 유지 (Non-churn) | 883,630 | 91.01% |
| 1 | 이탈 (Churn) | 87,330 | 8.99% |

---

## 2. members_v3.csv

> 사용자 기본 정보 - 가입 시점 수집 데이터

| # | 컬럼명 | 데이터 타입 | 설명 | 비즈니스 의미 | 예시값 | 결측치 |
|---|--------|-------------|------|---------------|--------|--------|
| 1 | `msno` | string (hash) | 사용자 고유 ID | 회원 식별자 | `Rb9UwL...` | 0 |
| 2 | `city` | int | 도시 코드 | 거주 지역 | 1 ~ 22 | 0 |
| 3 | `bd` | int | 나이 (birth date) | 연령 정보 | 0 ~ 99* | 0 |
| 4 | `gender` | string | 성별 | 성별 정보 | male, female | **65.4%** |
| 5 | `registered_via` | int | 가입 경로 | 가입 채널 | 3, 4, 7, 9, 13 | 0 |
| 6 | `registration_init_time` | int (YYYYMMDD) | 가입일 | 서비스 가입 시점 | 20110911 | 0 |

### 컬럼별 상세 정보

#### city (도시 코드)
| 값 | 의미 |
|----|------|
| 1 ~ 22 | 대만 도시 코드 (익명화) |
| 0 | 미입력/알수없음 |

#### bd (나이)
| 범위 | 의미 | 비고 |
|------|------|------|
| 1 ~ 99 | 정상 나이 | 유효 범위 |
| 0 | 미입력 | 매우 많음 (50%+) |
| 음수, 100+ | 이상치 | 전처리 필요 |

#### gender (성별)
| 값 | 의미 | 사용자 수 |
|----|------|-----------|
| male | 남성 | 1,195,355 |
| female | 여성 | 1,144,613 |
| NaN | 미입력 | 4,429,505 |

#### registered_via (가입 경로)
| 값 | 의미 (추정) |
|----|-------------|
| 3 | 모바일 앱 |
| 4 | 웹 |
| 7 | iOS |
| 9 | Android |
| 13 | 기타 |

---

## 3. transactions_v2.csv

> 결제 및 구독 거래 내역

| # | 컬럼명 | 데이터 타입 | 설명 | 비즈니스 의미 | 예시값 | 결측치 |
|---|--------|-------------|------|---------------|--------|--------|
| 1 | `msno` | string (hash) | 사용자 고유 ID | 회원 식별자 | `++6eU4...` | 0 |
| 2 | `payment_method_id` | int | 결제 수단 코드 | 결제 방법 | 29 ~ 41 | 0 |
| 3 | `payment_plan_days` | int | 구독 기간 (일) | 플랜 기간 | 7, 30, 90, 180, 365, 410 | 0 |
| 4 | `plan_list_price` | int | 정가 (TWD) | 표시 가격 | 99 ~ 1,788 | 0 |
| 5 | `actual_amount_paid` | int | 실결제 금액 (TWD) | 실제 결제액 | 0 ~ 1,788 | 0 |
| 6 | `is_auto_renew` | int (0/1) | 자동 갱신 여부 | 자동 결제 설정 | 0, 1 | 0 |
| 7 | `transaction_date` | int (YYYYMMDD) | 거래일 | 결제 시점 | 20170131 | 0 |
| 8 | `membership_expire_date` | int (YYYYMMDD) | 만료일 | 구독 종료일 | 20170504 | 0 |
| 9 | `is_cancel` | int (0/1) | 취소 여부 | 거래 취소 | 0, 1 | 0 |

### 컬럼별 상세 정보

#### payment_method_id (결제 수단)
| 값 | 거래 수 | 비율 |
|----|---------|------|
| 41 | 696,696 | 48.7% |
| 39 | 137,120 | 9.6% |
| 38 | 115,875 | 8.1% |
| 32 | 100,982 | 7.1% |
| 36 | 90,844 | 6.3% |
| 기타 | 289,492 | 20.2% |

#### payment_plan_days (구독 기간)
| 값 | 의미 |
|----|------|
| 7 | 1주 플랜 |
| 30 | 월간 플랜 |
| 90 | 분기 플랜 |
| 180 | 반기 플랜 |
| 365 | 연간 플랜 |
| 410 | 장기 플랜 |

#### is_auto_renew (자동 갱신)
| 값 | 의미 | 거래 수 | 비율 |
|----|------|---------|------|
| 0 | 자동갱신 OFF | 307,234 | 21.5% |
| 1 | 자동갱신 ON | 1,123,775 | **78.5%** |

> **💡 인사이트**: 자동갱신 OFF = 이탈 위험 신호

#### is_cancel (취소)
| 값 | 의미 | 거래 수 | 비율 |
|----|------|---------|------|
| 0 | 정상 거래 | 1,395,876 | 97.5% |
| 1 | 취소됨 | 35,133 | 2.5% |

#### 날짜 범위
| 컬럼 | Min | Max |
|------|-----|-----|
| transaction_date | 2015-01-01 | 2017-03-31 |
| membership_expire_date | 2016-04-19 | 2036-10-15 |

---

## 4. user_logs_v2.csv

> 일별 음악 청취 로그 (2017년 3월)

| # | 컬럼명 | 데이터 타입 | 설명 | 비즈니스 의미 | 예시값 | 결측치 |
|---|--------|-------------|------|---------------|--------|--------|
| 1 | `msno` | string (hash) | 사용자 고유 ID | 회원 식별자 | `u9E91Q...` | 0 |
| 2 | `date` | int (YYYYMMDD) | 날짜 | 로그 기록일 | 20170331 | 0 |
| 3 | `num_25` | int | 25% 미만 청취 곡 수 | **스킵** 곡 | 5 | 0 |
| 4 | `num_50` | int | 25-50% 청취 곡 수 | 부분 청취 | 3 | 0 |
| 5 | `num_75` | int | 50-75% 청취 곡 수 | 부분 청취 | 2 | 0 |
| 6 | `num_985` | int | 75-98.5% 청취 곡 수 | 거의 완주 | 4 | 0 |
| 7 | `num_100` | int | 98.5%+ 청취 곡 수 | **완주** 곡 | 10 | 0 |
| 8 | `num_unq` | int | 고유 곡 수 | 청취 다양성 | 18 | 0 |
| 9 | `total_secs` | float | 총 청취 시간 (초) | 일일 사용량 | 6309.273 | 0 |

### 컬럼별 비즈니스 의미

#### 청취 완료율 컬럼

```
┌──────────┬──────────┬──────────┬──────────┬──────────┐
│  num_25  │  num_50  │  num_75  │  num_985 │  num_100 │
│  < 25%   │ 25-50%   │ 50-75%   │ 75-98.5% │  > 98.5% │
├──────────┴──────────┴──────────┴──────────┴──────────┤
│  스킵       부분 청취         부분 청취       완주      │
│  (불만족)   (관심 있음)       (관심 있음)   (만족)     │
└─────────────────────────────────────────────────────┘
```

| 컬럼 | 의미 | 이탈 신호 |
|------|------|-----------|
| `num_25` ↑ | 스킵 많음 | 🔴 콘텐츠 불만족 |
| `num_100` ↓ | 완주 적음 | 🔴 몰입도 저하 |
| `num_unq` ↓ | 다양성 감소 | 🟡 탐색 감소 |
| `total_secs` ↓ | 사용 시간 감소 | 🔴 관심 저하 |

#### 날짜 범위
| Min | Max | 기간 |
|-----|-----|------|
| 2017-03-01 | 2017-03-31 | **30일** |

#### 고유 사용자
- **1,103,894명** (train의 77.7%)

---

## 5. 테이블 간 Key 관계

### 5.1 Primary Key / Foreign Key

| 테이블 | Key | 역할 |
|--------|-----|------|
| `train_v2` | `msno` | Primary (기준) |
| `members_v3` | `msno` | Primary |
| `transactions_v2` | `msno` | Foreign Key |
| `user_logs_v2` | `msno` | Foreign Key |

### 5.2 조인 관계

```sql
-- 최종 학습 데이터 구성
SELECT *
FROM train_v2 t
LEFT JOIN members_v3 m ON t.msno = m.msno
LEFT JOIN (
    -- transactions 집계
    SELECT msno, ... FROM transactions_v2 GROUP BY msno
) txn ON t.msno = txn.msno
LEFT JOIN (
    -- user_logs 집계
    SELECT msno, ... FROM user_logs_v2 GROUP BY msno
) logs ON t.msno = logs.msno
```

---

## 6. 데이터 품질 요약

### 6.1 결측치 현황

| 테이블 | 컬럼 | 결측 수 | 결측률 | 처리 방안 |
|--------|------|---------|--------|-----------|
| members_v3 | gender | 4,429,505 | 65.4% | → "unknown" |
| members_v3 | bd (유효값 외) | 다수 | - | → 중앙값 |

### 6.2 이상치 현황

| 테이블 | 컬럼 | 이상치 | 처리 방안 |
|--------|------|--------|-----------|
| members_v3 | bd | 음수, 0, 100+ | 0 < bd < 100 범위 외 → 중앙값 |

### 6.3 커버리지 이슈

| 이슈 | 사용자 수 | 처리 방안 |
|------|-----------|-----------|
| train - members (회원정보 없음) | 109,993 | 결측 → 기본값 |
| train - transactions (거래 없음) | 37,382 | 결측 → 0 |
| train - user_logs (3월 로그 없음) | 216,409 | 결측 → 0 (활동 없음 신호) |

---

## 7. 파생 피처 정의

### 7.1 user_logs 기반 파생 피처

| 파생 피처 | 계산식 | 의미 |
|-----------|--------|------|
| `total_songs` | num_25 + num_50 + num_75 + num_985 + num_100 | 총 재생 곡 수 |
| `skip_ratio` | num_25 / total_songs | 스킵율 |
| `complete_ratio` | num_100 / total_songs | 완주율 |
| `active_days` | count(distinct date) | 활동 일수 |
| `avg_songs_per_day` | total_songs / active_days | 일평균 재생 |

### 7.2 transactions 기반 파생 피처

| 파생 피처 | 계산식 | 의미 |
|-----------|--------|------|
| `days_to_expire` | membership_expire_date - T | 만료까지 남은 일수 |
| `discount_rate` | 1 - (actual / list_price) | 할인율 |
| `has_cancelled` | max(is_cancel) | 취소 이력 유무 |
| `transaction_count` | count(*) | 거래 횟수 |

### 7.3 members 기반 파생 피처

| 파생 피처 | 계산식 | 의미 |
|-----------|--------|------|
| `tenure_days` | T - registration_init_time | 가입 후 경과 일수 |

---

## 8. 비즈니스 용어 정의

| 용어 | 정의 |
|------|------|
| **Churn (이탈)** | 구독 만료 후 재구독하지 않은 상태 |
| **Retention (유지)** | 구독을 계속 유지하는 상태 |
| **Auto-renew** | 자동 결제 갱신 설정 |
| **Skip** | 곡을 25% 미만 듣고 넘긴 행동 |
| **Complete** | 곡을 98.5% 이상 들은 행동 |
| **Observation Window** | 피처 생성에 사용하는 기간 (30일) |
| **Prediction Window** | 이탈 여부를 판단하는 기간 |

---

> **📌 이 데이터 사전은 전처리 및 피처 엔지니어링의 기준 문서로 사용됩니다.**

